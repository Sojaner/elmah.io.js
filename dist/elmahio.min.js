/*!
 * elmah.io Javascript Logger - version 3.0.0-beta1
 * (c) 2018 elmah.io, Apache 2.0 License, https://elmah.io
 */
!function(e,n){"function"==typeof define&&define.amd?define([],function(){return n(e)}):"object"==typeof exports?module.exports=n(e):e.Elmahio=n(e)}("undefined"!=typeof global?global:"undefined"!=typeof window?window:this,function(e){"use strict";var n=document.getElementsByTagName("script"),t=function(e){var n=new Object;if(!e)return n;for(var t=e.split(/[;&]/),r=0;r<t.length;r++){var o=t[r].split("=");if(o&&2===o.length){var i=unescape(o[0]),a=unescape(o[1]);a=a.replace(/\+/g," "),n[i]=a}}return n}(n[n.length-1].src.replace(/^[^\?]+\??/,"")),r=function(e){var n,t=0;for(n in e)e.hasOwnProperty(n)&&t++;return t}(t),o={label:" elmah.io debugger : On ",labelCSS:"background: #06a89c; color: #ffffff; display: inline-block; font-size: 14px;",successCSS:"background: #d4edda; color: #155724; display: inline-block; font-size: 13px;",errorCSS:"background: #f8d7da; color: #721c24; display: inline-block; font-size: 13px;",warningCSS:"background: #fff3cd; color: #856404; display: inline-block; font-size: 13px;",lightCSS:"background: #e2e3e5; color: #383d41; display: inline-block; font-size: 13px;"},i={apiKey:null,logId:null,debug:!1,application:null,onFilter:null},a=function(){var e={},n=!1,t=0;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(n=arguments[0],t++);for(var r=function(t){for(var r in t)t.hasOwnProperty(r)&&(n&&"[object Object]"===Object.prototype.toString.call(t[r])?e[r]=a(e[r],t[r]):e[r]=t[r])};t<arguments.length;t++){r(arguments[t])}return e};function l(){var n=e.location.search.substr(1);return null!==n&&""!==n?function(e){for(var n=[],t=e.split("&"),r=0;r<t.length;r++){var o=t[r].split("=");n.push({key:o[0],value:o[1]})}return n}(n):{}}function s(e,n){var t={};for(var r in e)t[r]=e[r];for(var o in n)t[o]=n[o];return t}function c(e){var n=/(^|@)\S+\:\d+/,t=/^\s*at .*(\S+\:\d+|\(native\))/m,r=/^(eval@)?(\[native code\])?$/;return{parse:function(n){return void 0!==n.stacktrace||void 0!==n["opera#sourceloc"]?this.parseOpera(n):n.stack&&n.stack.match(t)?this.parseV8OrIE(n):n.stack?this.parseFFOrSafari(n):e.debug?void console.log("%c Cannot parse given Error object",o.warningCSS):null},extractLocation:function(e){if(-1===e.indexOf(":"))return[e];var n=/(.+?)(?:\:(\d+))?(?:\:(\d+))?$/.exec(e.replace(/[\(\)]/g,""));return[n[1],n[2]||void 0,n[3]||void 0]},parseV8OrIE:function(e){return e.stack.split("\n").filter(function(e){return!!e.match(t)},this).map(function(e){e.indexOf("(eval ")>-1&&(e=e.replace(/eval code/g,"eval").replace(/(\(eval at [^\()]*)|(\)\,.*$)/g,""));var n=e.replace(/^\s+/,"").replace(/\(eval code/g,"(").split(/\s+/).slice(1),t=this.extractLocation(n.pop());return{functionName:n.join(" ")||void 0,fileName:["eval","<anonymous>"].indexOf(t[0])>-1?void 0:t[0],lineNumber:t[1],columnNumber:t[2],source:e}},this)},parseFFOrSafari:function(e){return e.stack.split("\n").filter(function(e){return!e.match(r)},this).map(function(e){if(e.indexOf(" > eval")>-1&&(e=e.replace(/ line (\d+)(?: > eval line \d+)* > eval\:\d+\:\d+/g,":$1")),-1===e.indexOf("@")&&-1===e.indexOf(":"))return{functionName:e};var n=/((.*".+"[^@]*)?[^@]*)(?:@)/,t=e.match(n),r=t&&t[1]?t[1]:void 0,o=this.extractLocation(e.replace(n,""));return{functionName:r,fileName:o[0],lineNumber:o[1],columnNumber:o[2],source:e}},this)},parseOpera:function(e){return!e.stacktrace||e.message.indexOf("\n")>-1&&e.message.split("\n").length>e.stacktrace.split("\n").length?this.parseOpera9(e):e.stack?this.parseOpera11(e):this.parseOpera10(e)},parseOpera9:function(e){for(var n=/Line (\d+).*script (?:in )?(\S+)/i,t=e.message.split("\n"),r=[],o=2,i=t.length;o<i;o+=2){var a=n.exec(t[o]);a&&r.push({fileName:a[2],lineNumber:a[1],source:t[o]})}return r},parseOpera10:function(e){for(var n=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,t=e.stacktrace.split("\n"),r=[],o=0,i=t.length;o<i;o+=2){var a=n.exec(t[o]);a&&r.push({functionName:a[3]||void 0,fileName:a[2],lineNumber:a[1],source:t[o]})}return r},parseOpera11:function(e){return e.stack.split("\n").filter(function(e){return!!e.match(n)&&!e.match(/^Error created at/)},this).map(function(e){var n,t=e.split("@"),r=this.extractLocation(t.pop()),o=t.shift()||"",i=o.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^\)]*\)/g,"")||void 0;return o.match(/\(([^\)]*)\)/)&&(n=o.replace(/^[^\(]+\(([^\)]*)\)$/,"$1")),{functionName:i,args:void 0===n||"[arguments not available]"===n?void 0:n.split(","),fileName:r[0],lineNumber:r[1],columnNumber:r[2],source:e}},this)}}}var u=function(n){var u,p={};function d(){var n={url:[document.location.protocol,"//",document.location.host,document.location.pathname,document.location.hash].join("")||"/",application:u.application},t=[];navigator.language&&t.push({key:"User-Language",value:navigator.language}),document.documentMode&&t.push({key:"Document-Mode",value:document.documentMode}),(e.innerWidth||document.documentElement.clientWidth||document.getElementsByTagName("body")[0].clientWidth)&&t.push({key:"Browser-Width",value:e.innerWidth||document.documentElement.clientWidth||document.getElementsByTagName("body")[0].clientWidth}),(e.innerHeight||document.documentElement.clientHeight||document.getElementsByTagName("body")[0].clientHeight)&&t.push({key:"Browser-Height",value:e.innerHeight||document.documentElement.clientHeight||document.getElementsByTagName("body")[0].clientHeight}),void 0!==(screen.msOrientation||(screen.orientation||screen.mozOrientation||{}).type)&&t.push({key:"Screen-Orientation",value:(screen.msOrientation||(screen.orientation||screen.mozOrientation||{}).type).split("-")[0]}),screen.width&&t.push({key:"Screen-Width",value:screen.width}),screen.height&&t.push({key:"Screen-Height",value:screen.height}),screen.colorDepth&&t.push({key:"Color-Depth",value:screen.colorDepth}),t.push({key:"X-ELMAHIO-SEARCH-isClientside",value:"true"}),n.data=t;var r=[];return navigator.userAgent&&r.push({key:"User-Agent",value:navigator.userAgent}),document.referrer&&r.push({key:"Referer",value:document.referrer}),n.serverVariables=r,n}function f(e,n){u.debug&&("error"===e?console.log("%c ⯈ Error log: %c ✕ Not created ",o.lightCSS,o.errorCSS):"success"===e?console.log("%c ⯈ Error log: %c ✔ "+n+" at "+(new Date).toLocaleString()+" ",o.lightCSS,o.successCSS):console.log("%c ⯈ Error log: %c ✕ Not created. Title should not be undefined, null or empty ! ",o.lightCSS,o.errorCSS))}var g=function(e,n,o,i,a,f){var g=e,m=n,h=i,v=f,y=a,b=1,S=l();if((null===g||null===m)&&2!==r)return console.log("Login api error");t.hasOwnProperty("apiKey")&&t.hasOwnProperty("logId")&&(g=t.apiKey,m=t.logId);var O=new XMLHttpRequest;if(O.open("POST","https://api.elmah.io/v3/messages/"+m+"?api_key="+g,!0),O.setRequestHeader("Content-type","application/json"),O.onload=function(e){4===O.readyState&&201===O.status&&o("success",O.statusText)},O.onerror=function(e){o("error",O.statusText),p.emit("error",O.status,O.statusText)},"Log"!==h){var k=v?c(u).parse(v):null,N={title:y,source:k&&k.length>0?k[0].fileName:null,detail:v?v.stack:null,severity:h,type:v?v.name:null,queryString:JSON.parse(JSON.stringify(S))};N=s(N,d())}else N=v;null!==u.onFilter&&u.onFilter(N)&&(b=0),p.emit("message",N),1===b&&(N.title?O.send(JSON.stringify(N)):o("missing-title",O.statusText))};return p.error=function(e){g(u.apiKey,u.logId,f,"Error",e)},p.error=function(e,n){g(u.apiKey,u.logId,f,"Error",e,n)},p.verbose=function(e){g(u.apiKey,u.logId,f,"Verbose",e)},p.verbose=function(e,n){g(u.apiKey,u.logId,f,"Verbose",e,n)},p.debug=function(e){g(u.apiKey,u.logId,f,"Debug",e)},p.debug=function(e,n){g(u.apiKey,u.logId,f,"Debug",e,n)},p.information=function(e){g(u.apiKey,u.logId,f,"Information",e)},p.information=function(e,n){g(u.apiKey,u.logId,f,"Information",e,n)},p.warning=function(e){g(u.apiKey,u.logId,f,"Warning",e)},p.warning=function(e,n){g(u.apiKey,u.logId,f,"Warning",e,n)},p.fatal=function(e){g(u.apiKey,u.logId,f,"Fatal",e)},p.fatal=function(e,n){g(u.apiKey,u.logId,f,"Fatal",e,n)},p.log=function(e){g(u.apiKey,u.logId,f,"Log",null,e)},p.on=function(e,n,t){var r=this.e||(this.e={});return(r[e]||(r[e]=[])).push({fn:n,ctx:t}),this},p.emit=function(e){for(var n=[].slice.call(arguments,1),t=((this.e||(this.e={}))[e]||[]).slice(),r=0,o=t.length;r<o;r++)t[r].fn.apply(t[r].ctx,n);return this},p.init=function(n){u=a(i,n||{}),e.onerror=function(e,n,o,i,a){var g={message:e,source:n,lineno:o,colno:i,error:a};return function(e,n,o,i){var a=e,f=n,g=i,m=1,h=l();if((null===a||null===f)&&2!==r)return console.log("Login api error");t.hasOwnProperty("apiKey")&&t.hasOwnProperty("logId")&&(a=t.apiKey,f=t.logId);var v=new XMLHttpRequest;v.open("POST","https://api.elmah.io/v3/messages/"+f+"?api_key="+a,!0),v.setRequestHeader("Content-type","application/json"),v.onload=function(e){4===v.readyState&&201===v.status&&o("success",v.statusText)},v.onerror=function(e){o("error",v.statusText),p.emit("error",v.status,v.statusText)};var y=c(u).parse(g.error),b={detail:g.error.stack,title:g.message||"Unspecified error",source:y&&y.length>0?y[0].fileName:null,severity:"Error",type:g.error.name,queryString:JSON.parse(JSON.stringify(h))};b=s(b,d()),null!==u.onFilter&&u.onFilter(b)&&(m=0),p.emit("message",b),1===m&&v.send(JSON.stringify(b))}(u.apiKey,u.logId,f,g),!1}},p.init(n),u.debug&&console.log("%c"+o.label,o.labelCSS),p};return r&&t.hasOwnProperty("apiKey")&&t.hasOwnProperty("logId")?new u:u});
//# sourceMappingURL=elmahio.min.js.map
