/*!
 * elmah.io Javascript Logger - version 3.0.0-beta2
 * (c) 2018 elmah.io, Apache 2.0 License, https://elmah.io
 */
!function(e,n){"function"==typeof define&&define.amd?define([],function(){return n(e)}):"object"==typeof exports?module.exports=n(e):e.Elmahio=n(e)}("undefined"!=typeof global?global:"undefined"!=typeof window?window:this,function(e){"use strict";var n,t,r,i=function(){function e(e){return!isNaN(parseFloat(e))&&isFinite(e)}function n(e){return e.charAt(0).toUpperCase()+e.substring(1)}function t(e){return function(){return this[e]}}var r=["isConstructor","isEval","isNative","isToplevel"],i=["columnNumber","lineNumber"],o=["fileName","functionName","source"],a=r.concat(i,o,["args"]);function s(e){if(e instanceof Object)for(var t=0;t<a.length;t++)e.hasOwnProperty(a[t])&&void 0!==e[a[t]]&&this["set"+n(a[t])](e[a[t]])}s.prototype={getArgs:function(){return this.args},setArgs:function(e){if("[object Array]"!==Object.prototype.toString.call(e))throw new TypeError("Args must be an Array");this.args=e},getEvalOrigin:function(){return this.evalOrigin},setEvalOrigin:function(e){if(e instanceof s)this.evalOrigin=e;else{if(!(e instanceof Object))throw new TypeError("Eval Origin must be an Object or StackFrame");this.evalOrigin=new s(e)}},toString:function(){return(this.getFunctionName()||"{anonymous}")+("("+(this.getArgs()||[]).join(",")+")")+(this.getFileName()?"@"+this.getFileName():"")+(e(this.getLineNumber())?":"+this.getLineNumber():"")+(e(this.getColumnNumber())?":"+this.getColumnNumber():"")}},s.fromString=function(e){var n=e.indexOf("("),t=e.lastIndexOf(")"),r=e.substring(0,n),i=e.substring(n+1,t).split(","),o=e.substring(t+1);if(0===o.indexOf("@"))var a=/@(.+?)(?::(\d+))?(?::(\d+))?$/.exec(o,""),u=a[1],c=a[2],l=a[3];return new s({functionName:r,args:i||void 0,fileName:u,lineNumber:c||void 0,columnNumber:l||void 0})};for(var u=0;u<r.length;u++)s.prototype["get"+n(r[u])]=t(r[u]),s.prototype["set"+n(r[u])]=function(e){return function(n){this[e]=Boolean(n)}}(r[u]);for(var c=0;c<i.length;c++)s.prototype["get"+n(i[c])]=t(i[c]),s.prototype["set"+n(i[c])]=function(n){return function(t){if(!e(t))throw new TypeError(n+" must be a Number");this[n]=Number(t)}}(i[c]);for(var l=0;l<o.length;l++)s.prototype["get"+n(o[l])]=t(o[l]),s.prototype["set"+n(o[l])]=function(e){return function(n){this[e]=String(n)}}(o[l]);return s}(),o=(n=/(^|@)\S+\:\d+/,t=/^\s*at .*(\S+\:\d+|\(native\))/m,r=/^(eval@)?(\[native code\])?$/,{parse:function(e){if(void 0!==e.stacktrace||void 0!==e["opera#sourceloc"])return this.parseOpera(e);if(e.stack&&e.stack.match(t))return this.parseV8OrIE(e);if(e.stack)return this.parseFFOrSafari(e);throw new Error("Cannot parse given Error object")},extractLocation:function(e){if(-1===e.indexOf(":"))return[e];var n=/(.+?)(?:\:(\d+))?(?:\:(\d+))?$/.exec(e.replace(/[\(\)]/g,""));return[n[1],n[2]||void 0,n[3]||void 0]},parseV8OrIE:function(e){return e.stack.split("\n").filter(function(e){return!!e.match(t)},this).map(function(e){e.indexOf("(eval ")>-1&&(e=e.replace(/eval code/g,"eval").replace(/(\(eval at [^\()]*)|(\)\,.*$)/g,""));var n=e.replace(/^\s+/,"").replace(/\(eval code/g,"(").split(/\s+/).slice(1),t=this.extractLocation(n.pop()),r=n.join(" ")||void 0,o=["eval","<anonymous>"].indexOf(t[0])>-1?void 0:t[0];return new i({functionName:r,fileName:o,lineNumber:t[1],columnNumber:t[2],source:e})},this)},parseFFOrSafari:function(e){return e.stack.split("\n").filter(function(e){return!e.match(r)},this).map(function(e){if(e.indexOf(" > eval")>-1&&(e=e.replace(/ line (\d+)(?: > eval line \d+)* > eval\:\d+\:\d+/g,":$1")),-1===e.indexOf("@")&&-1===e.indexOf(":"))return new i({functionName:e});var n=/((.*".+"[^@]*)?[^@]*)(?:@)/,t=e.match(n),r=t&&t[1]?t[1]:void 0,o=this.extractLocation(e.replace(n,""));return new i({functionName:r,fileName:o[0],lineNumber:o[1],columnNumber:o[2],source:e})},this)},parseOpera:function(e){return!e.stacktrace||e.message.indexOf("\n")>-1&&e.message.split("\n").length>e.stacktrace.split("\n").length?this.parseOpera9(e):e.stack?this.parseOpera11(e):this.parseOpera10(e)},parseOpera9:function(e){for(var n=/Line (\d+).*script (?:in )?(\S+)/i,t=e.message.split("\n"),r=[],o=2,a=t.length;o<a;o+=2){var s=n.exec(t[o]);s&&r.push(new i({fileName:s[2],lineNumber:s[1],source:t[o]}))}return r},parseOpera10:function(e){for(var n=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,t=e.stacktrace.split("\n"),r=[],o=0,a=t.length;o<a;o+=2){var s=n.exec(t[o]);s&&r.push(new i({functionName:s[3]||void 0,fileName:s[2],lineNumber:s[1],source:t[o]}))}return r},parseOpera11:function(e){return e.stack.split("\n").filter(function(e){return!!e.match(n)&&!e.match(/^Error created at/)},this).map(function(e){var n,t=e.split("@"),r=this.extractLocation(t.pop()),o=t.shift()||"",a=o.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^\)]*\)/g,"")||void 0;o.match(/\(([^\)]*)\)/)&&(n=o.replace(/^[^\(]+\(([^\)]*)\)$/,"$1"));var s=void 0===n||"[arguments not available]"===n?void 0:n.split(",");return new i({functionName:a,args:s,fileName:r[0],lineNumber:r[1],columnNumber:r[2],source:e})},this)}}),a=function(n,t){function r(e){return new Promise(function(n,t){var r=new XMLHttpRequest;r.open("get",e),r.onerror=t,r.onreadystatechange=function(){4===r.readyState&&(r.status>=200&&r.status<300||"file://"===e.substr(0,7)&&r.responseText?n(r.responseText):t(new Error("HTTP status: "+r.status+" retrieving "+e)))},r.send()})}function i(n){if(void 0!==e&&e.atob)return e.atob(n);throw new Error("You must supply a polyfill for window.atob in this environment")}function o(e){if("object"!=typeof e)throw new TypeError("Given StackFrame is not an object");if("string"!=typeof e.fileName)throw new TypeError("Given file name is not a String");if("number"!=typeof e.lineNumber||e.lineNumber%1!=0||e.lineNumber<1)throw new TypeError("Given line number must be a positive integer");if("number"!=typeof e.columnNumber||e.columnNumber%1!=0||e.columnNumber<0)throw new TypeError("Given column number must be a non-negative integer");return!0}return function e(n){if(!(this instanceof e))return new e(n);n=n||{},this.sourceCache=n.sourceCache||{},this.sourceMapConsumerCache=n.sourceMapConsumerCache||{},this.ajax=n.ajax||r,this._atob=n.atob||i,this._get=function(e){return new Promise(function(t,r){var i="data:"===e.substr(0,5);if(this.sourceCache[e])t(this.sourceCache[e]);else if(n.offline&&!i)r(new Error("Cannot make network requests in offline mode"));else if(i){var o=e.match(/^data:application\/json;([\w=:"-]+;)*base64,/);if(o){var a=o[0].length,s=e.substr(a),u=this._atob(s);this.sourceCache[e]=u,t(u)}else r(new Error("The encoding of the inline sourcemap is not supported"))}else{var c=this.ajax(e,{method:"get"});this.sourceCache[e]=c,c.then(t,r)}}.bind(this))},this._getSourceMapConsumer=function(e,n){return new Promise(function(t,r){if(this.sourceMapConsumerCache[e])t(this.sourceMapConsumerCache[e]);else{var i=new Promise(function(t,r){return this._get(e).then(function(e){"string"==typeof e&&(e=function(e){if("undefined"!=typeof JSON&&JSON.parse)return JSON.parse(e);throw new Error("You must supply a polyfill for JSON.parse in this environment")}(e.replace(/^\)\]\}'/,""))),void 0===e.sourceRoot&&(e.sourceRoot=n),t(new(void 0).SourceMapConsumer(e))},r)}.bind(this));this.sourceMapConsumerCache[e]=i,t(i)}}.bind(this))},this.pinpoint=function(e){return new Promise(function(n,t){this.getMappedLocation(e).then(function(e){function t(){n(e)}this.findFunctionName(e).then(n,t).catch(t)}.bind(this),t)}.bind(this))},this.findFunctionName=function(e){return new Promise(function(n,r){o(e),this._get(e.fileName).then(function(r){var i=e.lineNumber,o=e.columnNumber,a=function(e,n){for(var t=[/['"]?([$_A-Za-z][$_A-Za-z0-9]*)['"]?\s*[:=]\s*function\b/,/function\s+([^('"`]*?)\s*\(([^)]*)\)/,/['"]?([$_A-Za-z][$_A-Za-z0-9]*)['"]?\s*[:=]\s*(?:eval|new Function)\b/,/\b(?!(?:if|for|switch|while|with|catch)\b)(?:(?:static)\s+)?(\S+)\s*\(.*?\)\s*\{/,/['"]?([$_A-Za-z][$_A-Za-z0-9]*)['"]?\s*[:=]\s*\(.*?\)\s*=>/],r=e.split("\n"),i="",o=Math.min(n,20),a=0;a<o;++a){var s=r[n-a-1],u=s.indexOf("//");if(u>=0&&(s=s.substr(0,u)),s){i=s+i;for(var c=t.length,l=0;l<c;l++){var f=t[l].exec(i);if(f&&f[1])return f[1]}}}}(r,i);n(a?new t({functionName:a,args:e.args,fileName:e.fileName,lineNumber:i,columnNumber:o}):e)},r).catch(r)}.bind(this))},this.getMappedLocation=function(e){return new Promise(function(n,r){!function(){if("function"!=typeof Object.defineProperty||"function"!=typeof Object.create)throw new Error("Unable to consume source maps in older browsers")}(),o(e);var i=this.sourceCache,a=e.fileName;this._get(a).then(function(r){var o=function(e){for(var n,t,r=/\/\/[#@] ?sourceMappingURL=([^\s'"]+)\s*$/gm;t=r.exec(e);)n=t[1];if(n)return n;throw new Error("sourceMappingURL not found")}(r),s="data:"===o.substr(0,5),u=a.substring(0,a.lastIndexOf("/")+1);return"/"===o[0]||s||/^https?:\/\/|^\/\//i.test(o)||(o=u+o),this._getSourceMapConsumer(o,u).then(function(r){return function(e,n,r){return new Promise(function(i,o){var a=n.originalPositionFor({line:e.lineNumber,column:e.columnNumber});if(a.source){var s=n.sourceContentFor(a.source);s&&(r[a.source]=s),i(new t({functionName:a.name||e.functionName,args:e.args,fileName:a.source,lineNumber:a.line,columnNumber:a.column}))}else o(new Error("Could not get original source for given stackframe and source map"))})}(e,r,i).then(n).catch(function(){n(e)})})}.bind(this),r).catch(r)}.bind(this))}}}(),s=document.getElementsByTagName("script"),u=function(e){var n=new Object;if(!e)return n;for(var t=e.split(/[;&]/),r=0;r<t.length;r++){var i=t[r].split("=");if(i&&2===i.length){var o=unescape(i[0]),a=unescape(i[1]);a=a.replace(/\+/g," "),n[o]=a}}return n}(s[s.length-1].src.replace(/^[^\?]+\??/,"")),c=function(e){var n,t=0;for(n in e)e.hasOwnProperty(n)&&t++;return t}(u),l={label:" elmah.io debugger : On ",labelCSS:"background: #06a89c; color: #ffffff; display: inline-block; font-size: 14px;",successCSS:"background: #d4edda; color: #155724; display: inline-block; font-size: 13px;",errorCSS:"background: #f8d7da; color: #721c24; display: inline-block; font-size: 13px;",warningCSS:"background: #fff3cd; color: #856404; display: inline-block; font-size: 13px;",lightCSS:"background: #e2e3e5; color: #383d41; display: inline-block; font-size: 13px;"},f={apiKey:null,logId:null,debug:!1,application:null,filter:null},p=function(){var e={},n=!1,t=0;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(n=arguments[0],t++);for(var r=function(t){for(var r in t)t.hasOwnProperty(r)&&(n&&"[object Object]"===Object.prototype.toString.call(t[r])?e[r]=p(e[r],t[r]):e[r]=t[r])};t<arguments.length;t++){r(arguments[t])}return e};function m(){var n=e.location.search.substr(1);return null!==n&&""!==n?function(e){for(var n=[],t=e.split("&"),r=0;r<t.length;r++){var i=t[r].split("=");n.push({key:i[0],value:i[1]})}return n}(n):{}}function h(e,n){var t={};for(var r in e)t[r]=e[r];for(var i in n)t[i]=n[i];return t}var g=function(n){var t,r={};function i(){var n={url:document.location.pathname||"/",application:t.application},r=[];navigator.language&&r.push({key:"User-Language",value:navigator.language}),document.documentMode&&r.push({key:"Document-Mode",value:document.documentMode}),(e.innerWidth||document.documentElement.clientWidth||document.getElementsByTagName("body")[0].clientWidth)&&r.push({key:"Browser-Width",value:e.innerWidth||document.documentElement.clientWidth||document.getElementsByTagName("body")[0].clientWidth}),(e.innerHeight||document.documentElement.clientHeight||document.getElementsByTagName("body")[0].clientHeight)&&r.push({key:"Browser-Height",value:e.innerHeight||document.documentElement.clientHeight||document.getElementsByTagName("body")[0].clientHeight}),void 0!==(screen.msOrientation||(screen.orientation||screen.mozOrientation||{}).type)&&r.push({key:"Screen-Orientation",value:(screen.msOrientation||(screen.orientation||screen.mozOrientation||{}).type).split("-")[0]}),screen.width&&r.push({key:"Screen-Width",value:screen.width}),screen.height&&r.push({key:"Screen-Height",value:screen.height}),screen.colorDepth&&r.push({key:"Color-Depth",value:screen.colorDepth}),r.push({key:"X-ELMAHIO-SEARCH-isClientside",value:"true"}),n.data=r;var i=[];return navigator.userAgent&&i.push({key:"User-Agent",value:navigator.userAgent}),document.referrer&&i.push({key:"Referer",value:document.referrer}),"https:"===document.location.protocol&&i.push({key:"HTTPS",value:"on"}),document.location.hostname&&i.push({key:"Host",value:document.location.hostname}),n.serverVariables=i,n}function s(e,n){t.debug&&("error"===e?console.log("%c ⯈ Error log: %c ✕ Not created ",l.lightCSS,l.errorCSS):"success"===e?console.log("%c ⯈ Error log: %c ✔ "+n+" at "+(new Date).toLocaleString()+" ",l.lightCSS,l.successCSS):console.log("%c ⯈ Error log: %c ✕ Not created. Title should not be undefined, null or empty ! ",l.lightCSS,l.errorCSS))}function g(e,n,t){var r=e.toString().split("\n")[0],i=new a;new Promise(function(n){var t=o.parse(e);n(Promise.all(t.map(function(e){return new Promise(function(n){function t(){n(e)}i.pinpoint(e).then(n,t).catch(t)})})))},function(e){console.log("pula")}).then(function(e){e.forEach(function(n,t){if(n.functionName)var r=n.functionName+" ";else r="";var i="    at "+r+"("+n.fileName+":"+n.lineNumber+":"+n.columnNumber+")";e[t]=i}),e.unshift(r),t.detail=e.join("\n"),n.send(JSON.stringify(t))})}var d=function(e,n,a,s,l,f){var p=e,d=n,v=s,b=f,y=l,N=1,w=m();if((null===p||null===d)&&2!==c)return console.log("Login api error");u.hasOwnProperty("apiKey")&&u.hasOwnProperty("logId")&&(p=u.apiKey,d=u.logId);var O=new XMLHttpRequest;if(O.open("POST","https://api.elmah.io/v3/messages/"+d+"?api_key="+p,!0),O.setRequestHeader("Content-type","application/json"),O.onload=function(e){4===O.readyState&&201===O.status&&a("success",O.statusText)},O.onerror=function(e){a("error",O.statusText),r.emit("error",O.status,O.statusText)},"Log"!==v){var S=b?o.parse(b):null,x={title:y,source:S&&S.length>0?S[0].fileName:null,detail:b?b.stack:null,severity:v,type:b?b.name:null,queryString:JSON.parse(JSON.stringify(w))};x=h(x,i())}else x=b;null!==t.filter&&t.filter(x)&&(N=0),1===N&&(x.title?(r.emit("message",x),b&&"Log"!==v&&"undefined"!=typeof Promise&&-1!==Promise.toString().indexOf("[native code]")?g(b,O,x):O.send(JSON.stringify(x))):a("missing-title",O.statusText))};return r.error=function(e){d(t.apiKey,t.logId,s,"Error",e)},r.error=function(e,n){d(t.apiKey,t.logId,s,"Error",e,n)},r.verbose=function(e){d(t.apiKey,t.logId,s,"Verbose",e)},r.verbose=function(e,n){d(t.apiKey,t.logId,s,"Verbose",e,n)},r.debug=function(e){d(t.apiKey,t.logId,s,"Debug",e)},r.debug=function(e,n){d(t.apiKey,t.logId,s,"Debug",e,n)},r.information=function(e){d(t.apiKey,t.logId,s,"Information",e)},r.information=function(e,n){d(t.apiKey,t.logId,s,"Information",e,n)},r.warning=function(e){d(t.apiKey,t.logId,s,"Warning",e)},r.warning=function(e,n){d(t.apiKey,t.logId,s,"Warning",e,n)},r.fatal=function(e){d(t.apiKey,t.logId,s,"Fatal",e)},r.fatal=function(e,n){d(t.apiKey,t.logId,s,"Fatal",e,n)},r.log=function(e){d(t.apiKey,t.logId,s,"Log",null,e)},r.on=function(e,n,t){var r=this.e||(this.e={});return(r[e]||(r[e]=[])).push({fn:n,ctx:t}),this},r.emit=function(e){for(var n=[].slice.call(arguments,1),t=((this.e||(this.e={}))[e]||[]).slice(),r=0,i=t.length;r<i;r++)t[r].fn.apply(t[r].ctx,n);return this},r.init=function(n){t=p(f,n||{}),e.onerror=function(e,n,a,l,f){var p={message:e,source:n,lineno:a,colno:l,error:f};return function(e,n,a,s){var l=e,f=n,p=s,d=1,v=m(),b=p.error?o.parse(p.error):"";if((null===l||null===f)&&2!==c)return console.log("Login api error");u.hasOwnProperty("apiKey")&&u.hasOwnProperty("logId")&&(l=u.apiKey,f=u.logId);var y=new XMLHttpRequest;y.open("POST","https://api.elmah.io/v3/messages/"+f+"?api_key="+l,!0),y.setRequestHeader("Content-type","application/json"),y.onload=function(e){4===y.readyState&&201===y.status&&a("success",y.statusText)},y.onerror=function(e){a("error",y.statusText),r.emit("error",y.status,y.statusText)};var N={detail:p.error?p.error.stack:null,title:p.message||"Unspecified error",source:b&&b.length>0?b[0].fileName:null,severity:"Error",type:p.error?p.error.name:null,queryString:JSON.parse(JSON.stringify(v))};N=h(N,i()),null!==t.filter&&t.filter(N)&&(d=0),1===d&&(r.emit("message",N),p.error&&"undefined"!=typeof Promise&&-1!==Promise.toString().indexOf("[native code]")?g(p.error,y,N):y.send(JSON.stringify(N)))}(t.apiKey,t.logId,s,p),!1}},r.init(n),t.debug&&console.log("%c"+l.label,l.labelCSS),r};return c&&u.hasOwnProperty("apiKey")&&u.hasOwnProperty("logId")?new g:g});
//# sourceMappingURL=elmahio.min.js.map
